# Profile data generated by Devel::NYTProf::Reader
# Version: v6.14
# More information at http://metacpan.org/release/Devel-NYTProf/
# Format: time,calls,time/call,code
0.000000,0,0.000000,#!/usr/bin/env perl
0.000026,2,0.000013,use v5.40;
0.000008,2,0.000004,use strict;
0.000795,2,0.000398,use warnings;
0.000572,2,0.000286,use Params::Filter qw/filter/;
0.000000,0,0.000000,
0.000000,0,0.000000,# Profiling Script for Params::Filter
0.000000,0,0.000000,# This script focuses on the most common use case to identify bottlenecks
0.000000,0,0.000000,# Run with: perl -d:NYTProf examples/profile.pl
0.000000,0,0.000000,# Then view: nytprofhtml
0.000000,0,0.000000,
0.000002,1,0.000002,say "Profiling Params::Filter...";
0.000000,0,0.000000,
0.000000,0,0.000000,# Test 1: Simple hashref filtering (most common case)
0.000000,0,0.000000,my @simple_data = map {
0.004517,1,0.004517,{
0.000000,0,0.000000,id     => $_,
0.000000,0,0.000000,name   => "User_$_",
0.000000,0,0.000000,email  => 'user' . $_ . '@example.com',
0.000000,0,0.000000,phone  => "555-$_",
0.000000,0,0.000000,city   => "City_$_",
0.000000,0,0.000000,extra1 => "data1",
0.000000,0,0.000000,extra2 => "data2",
0.000000,0,0.000000,extra3 => "data3",
0.000000,0,0.000000,}
0.000000,0,0.000000,} (1..10000);
0.000000,0,0.000000,
0.000000,1,0.000000,my @required = qw/id name email/;
0.000001,1,0.000001,my @accepted = qw/phone city/;
0.000000,1,0.000000,my @excluded = qw/extra1 extra2 extra3/;
0.000000,0,0.000000,
0.000002,1,0.000002,say "Test 1: Filtering 10,000 hashrefs (7 fields, keep 5, exclude 3)...";
0.000000,1,0.000000,for my $data (@simple_data) {
0.003515,10000,0.000000,my ($filtered, $msg) = filter($data, \@required, \@accepted, \@excluded);
0.000000,0,0.000000,}
0.000009,1,0.000009,say "Test 1 complete\n";
0.000000,0,0.000000,
0.000000,0,0.000000,# Test 2: Wildcard acceptance (common pattern)
0.000000,0,0.000000,my @wildcard_data = map {
0.004541,1,0.004541,{
0.000000,0,0.000000,id        => $_,
0.000000,0,0.000000,name      => "User_$_",
0.000000,0,0.000000,email     => 'user' . $_ . '@example.com',
0.000000,0,0.000000,password  => "secret$_",
0.000000,0,0.000000,ssn       => "123-$_",
0.000000,0,0.000000,field1    => "data1",
0.000000,0,0.000000,field2    => "data2",
0.000000,0,0.000000,field3    => "data3",
0.000000,0,0.000000,}
0.000000,0,0.000000,} (1..10000);
0.000000,0,0.000000,
0.000003,1,0.000003,say "Test 2: Filtering 10,000 hashrefs with wildcard (8 fields, exclude 2)...";
0.000000,1,0.000000,for my $data (@wildcard_data) {
0.004868,10000,0.000000,my ($filtered, $msg) = filter($data, ['id', 'name'], ['*'], ['password', 'ssn']);
0.000000,0,0.000000,}
0.000005,1,0.000005,say "Test 2 complete\n";
0.000000,0,0.000000,
0.000000,0,0.000000,# Test 3: OO interface with filter reuse
0.000001,1,0.000001,say "Test 3: OO interface with 10,000 calls...";
0.000005,1,0.000005,my $filter = Params::Filter->new_filter({
0.000000,0,0.000000,required => \@required,
0.000000,0,0.000000,accepted => \@accepted,
0.000000,0,0.000000,excluded => \@excluded,
0.000000,0,0.000000,});
0.000001,1,0.000001,for my $data (@simple_data) {
0.003299,10000,0.000000,my ($filtered, $msg) = $filter->apply($data);
0.000000,0,0.000000,}
0.000005,1,0.000005,say "Test 3 complete\n";
0.000000,0,0.000000,
0.000000,0,0.000000,# Test 4: Minimal case (required only)
0.000000,0,0.000000,my @minimal_data = map {
0.002152,1,0.002152,{
0.000000,0,0.000000,id    => $_,
0.000000,0,0.000000,name  => "User_$_",
0.000000,0,0.000000,email => 'user' . $_ . '@example.com',
0.000000,0,0.000000,}
0.000000,0,0.000000,} (1..10000);
0.000000,0,0.000000,
0.000005,1,0.000005,say "Test 4: Minimal filtering 10,000 hashrefs (3 required, no accepted)...";
0.000000,1,0.000000,for my $data (@minimal_data) {
0.002805,10000,0.000000,my ($filtered, $msg) = filter($data, \@required);
0.000000,0,0.000000,}
0.000006,1,0.000006,say "Test 4 complete\n";
0.000000,0,0.000000,
0.003873,1,0.003873,say "Profiling complete. Run 'nytprofhtml' to generate report.";
